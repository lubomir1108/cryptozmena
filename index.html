<!doctype html>
<html lang="sk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Arch√≠v Dediƒçstva ‚Äî Zanechaj odkaz nav≈ædy</title>
  <meta name="description" content="Zanechaj kr√°tky odkaz pre bud√∫ce gener√°cie ‚Äî nav≈ædy za 1 ‚Ç¨ alebo sk√∫si≈• zdarma 48h.">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#060407; --panel:#0f1216; --muted:#bdbdbd; --gold:#c89b2e; --gold-2:#e0b230; --accent:#10b981; --round:14px; --text:#f5f5f5;
      --glass: rgba(255,255,255,0.03);
      --max-width:1000px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{
      font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;
      color:var(--text);
      background:linear-gradient(180deg,#040405 0%, #0a0a0b 100%);
      padding:28px;display:flex;justify-content:center;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    .wrap{max-width:var(--max-width);width:100%}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:20px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--gold),var(--gold-2));display:flex;align-items:center;justify-content:center;font-weight:800;color:#0b0b0b;font-family:'Playfair Display',serif}
    h1{font-family:'Playfair Display',serif;margin:0;font-size:20px}
    .sub{color:var(--muted);font-size:13px}
    .lang-switch{display:flex;gap:8px}
    .lang-btn{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px 10px;border-radius:10px;color:var(--muted);cursor:pointer}
    .lang-btn.active{background:var(--gold);color:#0b0b0b;border-color:var(--gold)}
    .hero{display:grid;grid-template-columns:1fr 380px;gap:22px;align-items:center;padding:22px;border-radius:16px;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);border:1px solid rgba(255,255,255,0.03);backdrop-filter: blur(6px)}
    @media(max-width:920px){.hero{grid-template-columns:1fr;padding:18px}}
    .h-eyebrow{font-weight:700;color:var(--gold);font-size:13px}
    .h-title{font-family:'Playfair Display',serif;font-size:34px;margin:8px 0}
    .h-sub{color:var(--muted);margin-bottom:14px}
    .cta-row{display:flex;gap:12px;align-items:center}
    .primary{background:linear-gradient(90deg,var(--gold),var(--gold-2));border:0;padding:14px 18px;border-radius:12px;font-weight:800;color:#081018;cursor:pointer;box-shadow:0 14px 40px rgba(200,155,46,0.12)}
    .secondary{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:12px 16px;border-radius:10px;color:var(--muted);cursor:pointer}
    .panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);padding:16px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}
    label{display:block;color:var(--muted);font-size:13px;margin-bottom:8px}
    input[type=text], textarea{width:100%;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:rgba(255,255,255,0.02);color:var(--text)}
    textarea{min-height:120px;resize:vertical}
    .meta-row{display:flex;gap:10px;align-items:center;justify-content:space-between;margin-top:12px}
    .pill{padding:6px 10px;border-radius:999px;background:rgba(255,255,255,0.02);font-weight:700}
    .grid{display:grid;grid-template-columns:1fr 340px;gap:20px;margin-top:18px}
    @media(max-width:920px){.grid{grid-template-columns:1fr}}
    .list{display:flex;flex-direction:column;gap:12px;max-height:520px;overflow:auto;padding-right:6px}
    .item{padding:12px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);border:1px solid rgba(255,255,255,0.02)}
    .avatar{width:48px;height:48px;border-radius:10px;background:rgba(255,255,255,0.03);display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--muted)}
    footer{margin-top:26px;color:var(--muted);font-size:13px;text-align:center}
    .social-proof{display:flex;gap:12px;align-items:center;margin-top:12px}
    .proof-card{background:rgba(255,255,255,0.02);padding:10px;border-radius:10px;font-weight:700}
    .badge{display:inline-block;padding:6px 8px;border-radius:10px;background:linear-gradient(90deg,var(--gold),var(--gold-2));color:#0b0b0b;font-weight:800}
    .small{font-size:13px;color:var(--muted)}
    .sticky{position:fixed;left:50%;transform:translateX(-50%);bottom:18px;background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));padding:10px 14px;border-radius:999px;border:1px solid rgba(255,255,255,0.04);display:flex;gap:12px;align-items:center;z-index:1200}
    button:focus, input:focus, textarea:focus{outline:3px solid rgba(200,155,46,0.12);outline-offset:2px}

    /* simple modal for simulated payment */
    .modal {
      position: fixed; inset: 0; display: none; align-items: center; justify-content: center;
      background: rgba(0,0,0,0.6); z-index: 2000;
    }
    .modal .card {
      width: 360px; max-width: calc(100% - 32px); background: var(--panel); padding: 18px; border-radius: 12px; border:1px solid rgba(255,255,255,0.03);
    }
    .modal.show { display:flex; }
  </style>
</head>
<body>
  <div class="wrap" id="app">
    <header>
      <div class="brand">
        <div class="logo">Aƒå</div>
        <div>
          <h1 id="brandTitle">Arch√≠v Dediƒçstva</h1>
          <div class="sub" id="brandSub">Kapsula ƒåasu ‚Äî Zanechaj odkaz, ktor√Ω pre≈æije</div>
        </div>
      </div>

      <div class="lang-switch" role="tablist" aria-label="Jazyk">
        <button type="button" class="lang-btn active" data-lang="sk" aria-pressed="true">SK</button>
        <button type="button" class="lang-btn" data-lang="en" aria-pressed="false">EN</button>
      </div>
    </header>

    <section class="hero" aria-labelledby="heroTitle">
      <div class="hero-left">
        <div class="h-eyebrow" id="eyebrow">PREDAJN√â</div>
        <div class="h-title" id="heroTitle">ƒåas pominie. Odkaz zostane.</div>
        <div class="h-sub" id="heroSub">Zanechaj kr√°tku my≈°lienku, spomienku alebo odkaz, ktor√Ω si zachov√°≈° nav≈ædy ‚Äî alebo vysk√∫≈°aj zadarmo na 48 hod√≠n.</div>

        <div class="cta-row">
          <button type="button" class="primary" id="ctaPrimary">Zanecha≈• odkaz</button>
          <button type="button" class="secondary" id="ctaSecondary">Viac inform√°ci√≠</button>
        </div>

        <div class="social-proof" aria-hidden="true">
          <div class="proof-card">üëÅ <span id="totalViews">0</span> ƒç√≠tan√≠</div>
          <div class="proof-card">üåç <span id="countries">14</span> kraj√≠n</div>
          <div class="proof-card">üíå <span id="totalSaved">0</span> odkazov</div>
        </div>
      </div>

      <div class="panel" aria-labelledby="formTitle">
        <h3 id="formTitle">Zanechaj odkaz</h3>
        <label id="labelName">Meno / prez√Ωvka (nepovinn√©)</label>
        <input id="author" name="author" type="text" placeholder="Ako chcete by≈• zaznamenan√Ω?" aria-label="Meno alebo prez√Ωvka" />

        <label style="margin-top:10px">Tvoj odkaz <span class="small" id="charCount">0/300</span></label>
        <textarea id="message" maxlength="300" placeholder="Nap√≠≈° nieƒço, ƒço by si chcel, aby bud√∫ce gener√°cie vedeli..."></textarea>

        <div class="meta-row">
          <div class="pill" id="dailyInfo">Zost√°va 3 bezplatn√© ulo≈æenia</div>
          <div style="display:flex;gap:8px">
            <!-- Simulated Pay button -->
            <div id="sim-pay-container" aria-hidden="true"></div>
            <button type="button" class="secondary" id="freeBtn">Sk√∫si≈• zdarma (48h)</button>
            <button type="button" class="primary" id="payBtn" style="padding:10px 12px;font-weight:700">Zachova≈• ‚Äî 1 ‚Ç¨</button>
          </div>
        </div>
        <div class="small" style="margin-top:10px;color:var(--muted)">*Doƒçasn√© odkazy zanikn√∫ po 48 hodin√°ch. Trval√© odkazy z√≠skaj√∫ odznak uchovania.</div>
      </div>
    </section>

    <div class="grid">
      <main>
        <div class="panel">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <h3 id="listTitle">Najnov≈°ie odkazy</h3>
            <div class="small">Zobrazen√© <span id="listCount">0</span></div>
          </div>

          <div style="margin-top:12px;display:flex;gap:8px">
            <input id="search" type="text" placeholder="Hƒæada≈•..." aria-label="Hƒæada≈• odkazy" />
            <select id="sort">
              <option value="paid">Trval√© najprv</option>
              <option value="new">Najnov≈°ie</option>
              <option value="likes">Najviac uzn√°van√©</option>
            </select>
          </div>

          <div id="list" class="list" style="margin-top:14px">
            <div class="small">Zatiaƒæ ≈æiadne odkazy ‚Äî buƒè ten prv√Ω.</div>
          </div>
        </div>

        <div class="panel" style="margin-top:14px">
          <h3>FAQ</h3>
          <div class="small" style="margin-top:8px">
            <strong>Je to bezpeƒçn√©?</strong>
            <div>√Åno ‚Äî v tejto demo verzii je platba simulovan√°. Pri nasaden√≠ nahraj re√°lny PayPal Client ID do hlaviƒçky.</div>
            <div style="margin-top:8px"><strong>Preƒço 1 ‚Ç¨?</strong> N√≠zka vstupn√° cena pom√°ha zabezpeƒçi≈• d√¥stojn√© ulo≈æenie a √∫dr≈æbu obsahu.</div>
          </div>
        </div>
      </main>

      <aside>
        <div class="panel">
          <h3>≈†tatistiky</h3>
          <div class="small" style="margin-top:8px">Celkovo ulo≈æen√©: <strong id="statTotal">0</strong></div>
          <div class="small">Trval√©: <strong id="statPaid">0</strong></div>
          <div class="small">Doƒçasn√©: <strong id="statTemp">0</strong></div>
          <div class="small">Pr√≠jmy: <strong id="statRevenue">0 ‚Ç¨</strong></div>
          <div style="margin-top:12px"><button type="button" class="secondary" id="exportBtn">Exportova≈• (demo)</button></div>
        </div>

        <div class="panel" style="margin-top:14px">
          <h3>Top</h3>
          <div id="topList" class="small" style="margin-top:8px">‚Äî</div>
        </div>
      </aside>
    </div>

    <footer>¬© <span id="year"></span> Arch√≠v Dediƒçstva ‚Äî Premium v12</footer>
  </div>

  <div class="sticky" role="region" aria-label="R√Ωchla akcia">
    <div class="small">Chr√°≈à svoj odkaz</div>
    <button type="button" class="primary" id="stickyPay">Zachova≈• ‚Äî 1 ‚Ç¨</button>
  </div>

  <!--
    SIMULATED PAYMENT: No external PayPal SDK is loaded in this demo file.
    When you're ready to enable real PayPal:
    1) Get a PayPal Client ID (Sandbox or Live) from developer.paypal.com
    2) Add this script tag (replace YOUR_CLIENT_ID and CURRENCY if needed):
       <script src="https://www.paypal.com/sdk/js?client-id=YOUR_CLIENT_ID&currency=EUR"></script>
    3) Remove the simulated payment code below and initialise real PayPal Buttons.
  -->

  <!-- Simulated payment modal -->
  <div id="simModal" class="modal" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="card" role="document">
      <h3 id="simTitle">Simulovan√° platba</h3>
      <p id="simBody">Stlaƒç ‚ÄûPotvrdi≈•‚Äú pre simul√°ciu √∫spe≈°nej platby ‚Ç¨1.00 (sandbox).</p>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
        <button type="button" class="secondary" id="simCancel">Zru≈°i≈•</button>
        <button type="button" class="primary" id="simConfirm">Potvrdi≈•</button>
      </div>
    </div>
  </div>

  <script>
    /* --- CONFIG --- */
    const STORAGE_KEY = 'archiv_v12_entries';
    const DAILY_KEY = 'archiv_v12_daily';
    const LIKES_KEY = 'archiv_v12_likes';
    const VIEWED_SESSION_KEY = 'archiv_v12_viewed_ids';
    const TEMP_MS = 48*60*60*1000;
    const DAILY_LIMIT = 3;
    const PRICE = '1.00';
    const CURRENCY = 'EUR';
    let LANG = localStorage.getItem('archiv_lang') || 'sk';

    /* --- I18N --- */
    const I18N = {
      sk: {
        heroTitle: 'ƒåas pominie. Odkaz zostane.',
        heroSub: 'Zanechaj kr√°tku my≈°lienku, spomienku alebo odkaz, ktor√Ω pre≈æije ‚Äî nav≈ædy za 1 ‚Ç¨ alebo zdarma 48h.',
        cta: 'Zanecha≈• odkaz',
        more: 'Viac inform√°ci√≠',
        formTitle: 'Zanechaj odkaz',
        placeholder: 'Nap√≠≈° nieƒço, ƒço by si chcel, aby bud√∫ce gener√°cie vedeli...',
        freeBtn: 'Sk√∫si≈• zdarma (48h)',
        dailyFree: (n)=>`Zost√°va ${n} bezplatn√Ωch ulo≈æen√≠`,
        noResults: 'Zatiaƒæ ≈æiadne odkazy ‚Äî buƒè ten prv√Ω.',
        alertEmpty: 'Odkaz nesmie by≈• pr√°zdny.',
        alertLong: 'Maxim√°lne 300 znakov.',
        thanksPaid: 'ƒéakujeme ‚Äî tvoj odkaz je ulo≈æen√Ω nav≈ædy.',
        thanksTemp: 'Odkaz ulo≈æen√Ω doƒçasne (48h).',
        confirmContinue: 'Pokraƒçova≈•?',
        confirmLimitReached: 'Dne≈°n√Ω limit je vyƒçerpan√Ω. Ulo≈æi≈• ako doƒçasn√©?'
      },
      en: {
        heroTitle: 'Time will pass. The message remains.',
        heroSub: 'Leave a short thought, memory or message that will survive ‚Äî forever for ‚Ç¨1 or free 48h trial.',
        cta: 'Leave a message',
        more: 'More info',
        formTitle: 'Leave a message',
        placeholder: 'Write something you wish future generations to know...',
        freeBtn: 'Try free (48h)',
        dailyFree: (n)=>`${n} free saves remaining`,
        noResults: 'No messages yet ‚Äî be the first.',
        alertEmpty: 'Message cannot be empty.',
        alertLong: 'Max 300 characters.',
        thanksPaid: 'Thanks ‚Äî your message is saved forever.',
        thanksTemp: 'Message saved temporarily (48h).',
        confirmContinue: 'Continue?',
        confirmLimitReached: "Today's free limit exhausted. Save as temporary?"
      }
    };

    /* --- State --- */
    let entries = [];
    let daily = {count:0, date:Date.now()};
    let likes = new Set();

    /* --- Session-only viewed ids --- */
    function loadSessionViewed(){
      try{
        const raw = sessionStorage.getItem(VIEWED_SESSION_KEY);
        return raw ? new Set(JSON.parse(raw)) : new Set();
      }catch(e){ return new Set(); }
    }
    function saveSessionViewed(set){
      try{ sessionStorage.setItem(VIEWED_SESSION_KEY, JSON.stringify(Array.from(set))); }catch(e){}
    }
    const viewedIds = loadSessionViewed();
    function markViewed(id){
      viewedIds.add(id);
      saveSessionViewed(viewedIds);
    }

    /* --- Utils --- */
    const el = id => document.getElementById(id);
    const now = ()=>Date.now();
    function uid(p='id'){ return p + Math.random().toString(36).slice(2,9) }
    function save(){ try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(entries)); }catch(e){ console.error(e) } }
    function load(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        entries = raw ? JSON.parse(raw) : [];
        // remove expired temps
        entries = entries.filter(e => e.paid || (e.ts + TEMP_MS > now()));
        save();
      }catch(e){ entries = [] }
    }
    function loadDaily(){
      try{
        const raw = localStorage.getItem(DAILY_KEY);
        daily = raw ? JSON.parse(raw) : {count:0,date:now()};
        const dSaved = new Date(daily.date);
        const dNow = new Date();
        if(dSaved.getFullYear() !== dNow.getFullYear() || dSaved.getMonth() !== dNow.getMonth() || dSaved.getDate() !== dNow.getDate()){
          daily = {count:0, date: now()};
        }
      }catch(e){ daily = {count:0,date:now()} }
    }
    function saveDaily(){ localStorage.setItem(DAILY_KEY, JSON.stringify(daily)) }
    function remainingFree(){ loadDaily(); return Math.max(0, DAILY_LIMIT - (daily.count||0)) }
    function useFree(){ loadDaily(); if(daily.count < DAILY_LIMIT){ daily.count++; daily.date = now(); saveDaily(); return true } return false }
    function loadLikes(){ try{ const raw = localStorage.getItem(LIKES_KEY); likes = raw ? new Set(JSON.parse(raw)) : new Set(); }catch(e){ likes = new Set(); } }
    function saveLikes(){ localStorage.setItem(LIKES_KEY, JSON.stringify(Array.from(likes))) }
    function formatDate(ts){ return new Date(ts).toLocaleString(LANG==='sk' ? 'sk-SK' : 'en-GB', {year:'numeric',month:'short',day:'numeric',hour:'2-digit',minute:'2-digit'}) }

    /* --- Render / i18n --- */
    function applyLang(l){
      LANG = l;
      localStorage.setItem('archiv_lang', LANG);
      el('heroTitle').textContent = I18N[LANG].heroTitle;
      el('heroSub').textContent = I18N[LANG].heroSub;
      el('ctaPrimary').textContent = I18N[LANG].cta;
      el('ctaSecondary').textContent = I18N[LANG].more;
      el('formTitle').textContent = I18N[LANG].formTitle;
      el('freeBtn').textContent = I18N[LANG].freeBtn;
      el('message').placeholder = I18N[LANG].placeholder;
      document.querySelectorAll('.lang-btn').forEach(b=>{
        const is = b.dataset.lang===LANG;
        b.classList.toggle('active', is);
        b.setAttribute('aria-pressed', String(is));
      });
      render();
    }

    function render(){
      const listEl = el('list');
      const q = el('search').value.trim().toLowerCase();
      let list = entries.slice();
      list.forEach((e,i)=>e.rank=i+1);
      if(q) list = list.filter(e => (e.text + ' ' + (e.author||'')).toLowerCase().includes(q));
      const sort = el('sort').value;
      if(sort==='paid') list.sort((a,b)=> (b.paid?1:0)-(a.paid?1:0) || b.ts - a.ts);
      else if(sort==='new') list.sort((a,b)=> b.ts - a.ts);
      else if(sort==='likes') list.sort((a,b)=> (b.likes||0) - (a.likes||0));

      listEl.innerHTML = '';
      if(list.length===0){
        listEl.innerHTML = `<div class="small">${I18N[LANG].noResults}</div>`;
      } else {
        list.forEach(e=>{
          const item = document.createElement('div'); item.className='item';
          item.innerHTML = `
            <div style="display:flex;gap:12px;align-items:flex-start">
              <div class="avatar" aria-hidden="true">${(e.author||'--').slice(0,2).toUpperCase()}</div>
              <div style="flex:1">
                <div style="display:flex;align-items:center;gap:8px">
                  <div style="font-weight:700">${escapeHtml(e.author|| (LANG==='sk' ? 'Nezn√°my' : 'Anonymous'))}</div>
                  <div class="small">${formatDate(e.ts)}</div>
                  <div style="margin-left:auto">${e.paid ? '<span class="badge">DEDIƒåSTVO</span>' : '<span class="small">48h</span>'}</div>
                </div>
                <div style="margin-top:8px">${escapeHtml(e.text)}</div>
                <div style="margin-top:8px;font-size:13px;color:var(--muted)">
                  ‚ù§ ${e.likes||0} ‚Ä¢ ƒå√≠tan√≠: ${e.views||0}
                </div>
              </div>
            </div>
          `;
          listEl.appendChild(item);

          // Option A: count views once per session
          if(!viewedIds.has(e.id)){
            e.views = (e.views||0) + 1;
            markViewed(e.id);
            save();
          }
        });
      }

      // stats
      el('listCount').textContent = list.length;
      el('totalSaved').textContent = entries.length;
      el('statTotal').textContent = entries.length;
      el('statPaid').textContent = entries.filter(e=>e.paid).length;
      el('statTemp').textContent = entries.filter(e=>!e.paid).length;
      el('statRevenue').textContent = (entries.filter(e=>e.paid).length * parseFloat(PRICE)).toFixed(2) + ' ‚Ç¨';
      el('totalViews').textContent = entries.reduce((s,e)=>s+(e.views||0),0);
      el('topList').innerHTML = '';
      const top = entries.slice().sort((a,b)=> (b.likes||0) - (a.likes||0)).slice(0,5);
      if(top.length===0) el('topList').textContent = '‚Äî';
      else top.forEach((t,i)=> {
        const d = document.createElement('div'); d.className='small';
        d.innerHTML = `<strong>#${i+1} ${(t.author|| (LANG==='sk' ? 'Nezn√°my' : 'Anonymous'))}</strong>: ${truncate(t.text,60)} ‚Äî ‚ù§ ${t.likes||0}`;
        el('topList').appendChild(d);
      });

      el('dailyInfo').textContent = I18N[LANG].dailyFree(remainingFree());
    }

    function escapeHtml(s){ return String(s).replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])) }
    function truncate(s,n){ return s.length>n ? s.slice(0,n-1)+'‚Ä¶' : s }

    /* --- Actions --- */
    function addEntry({paid=false} = {}){
      const text = el('message').value.trim();
      const author = el('author').value.trim() || null;
      if(!text) return alert(I18N[LANG].alertEmpty);
      if(text.length > 300) return alert(I18N[LANG].alertLong);
      const entry = { id: uid('e_'), author, text, ts: now(), likes:0, views:0, paid: !!paid };
      entries.unshift(entry);
      save();
      el('author').value = ''; el('message').value = ''; el('charCount').textContent = '0/300';
      if(paid) alert(I18N[LANG].thanksPaid); else alert(I18N[LANG].thanksTemp);
      render();
    }

    function handleFree(){
      if(!el('message').value.trim()) return alert(I18N[LANG].alertEmpty);
      const rem = remainingFree();
      if(rem > 0){
        if(confirm(`${I18N[LANG].dailyFree(rem)} ${I18N[LANG].confirmContinue}`)){
          useFree();
          addEntry({paid:false});
        }
      } else {
        if(confirm(I18N[LANG].confirmLimitReached)) addEntry({paid:false});
      }
    }

    /* --- Simulated payment flow --- */
    function openSimPayment(){
      // show modal
      const modal = el('simModal');
      modal.classList.add('show');
      modal.setAttribute('aria-hidden','false');
    }
    function closeSimPayment(){
      const modal = el('simModal');
      modal.classList.remove('show');
      modal.setAttribute('aria-hidden','true');
    }

    function confirmSimPayment(){
      // simulate capture success and add paid entry
      closeSimPayment();
      addEntry({paid:true});
    }

    /* --- Init --- */
    function init(){
      // wire DOM
      el('year').textContent = new Date().getFullYear();
      el('charCount').textContent = '0/300';
      el('message').addEventListener('input', ()=> el('charCount').textContent = el('message').value.length + '/300');
      el('freeBtn').addEventListener('click', handleFree);
      el('ctaPrimary').addEventListener('click', ()=> { el('message').focus(); window.scrollTo({top: el('formTitle').offsetTop - 40, behavior:'smooth'})});
      el('payBtn').addEventListener('click', ()=> {
        if(!el('message').value.trim()){
          return alert(I18N[LANG].alertEmpty);
        }
        openSimPayment();
      });

      // sticky pay scroll to form and open simulated pay modal
      el('stickyPay').addEventListener('click', ()=> {
        window.scrollTo({top: el('formTitle').offsetTop - 40, behavior:'smooth'});
        setTimeout(()=> openSimPayment(), 400);
      });

      el('simCancel').addEventListener('click', closeSimPayment);
      el('simConfirm').addEventListener('click', confirmSimPayment);

      el('exportBtn').addEventListener('click', ()=> {
        try{
          const data = JSON.stringify(entries, null, 2);
          const blob = new Blob([data], {type:'application/json'});
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a'); a.href = url; a.download = 'archiv_entries.json';
          document.body.appendChild(a);
          a.click();
          setTimeout(()=> {
            URL.revokeObjectURL(url);
            if(a.parentNode) a.parentNode.removeChild(a);
          }, 1000);
        }catch(e){ console.error('Export failed', e) }
      });

      el('search').addEventListener('input', render);
      el('sort').addEventListener('change', render);

      document.querySelectorAll('.lang-btn').forEach(b=>b.addEventListener('click', (e)=>{
        applyLang(e.currentTarget.dataset.lang);
      }));

      load(); loadDaily(); loadLikes();
      applyLang(LANG);
      render();

      // simulate social-proof on first load
      if(!localStorage.getItem('archiv_v12_demo_seeded')){
        el('countries').textContent = 14 + Math.floor(Math.random()*30);
        localStorage.setItem('archiv_v12_demo_seeded','1');
      }
    }

    /* --- Small helpers --- */
    function loadLikes(){ try{ const raw = localStorage.getItem(LIKES_KEY); likes = raw ? new Set(JSON.parse(raw)) : new Set(); }catch(e){ likes = new Set(); } }
    function formatDate(ts){ return new Date(ts).toLocaleString(LANG==='sk' ? 'sk-SK' : 'en-GB', {year:'numeric',month:'short',day:'numeric',hour:'2-digit',minute:'2-digit'}) }

    // bootstrap
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
